---
title: spark 聚合进化
date: 2018-07-27 17:33:00
tags: [spark,agg,sql,pivot]
---

## 需求描述
>通过分析流水，然后统计商户维度的以下字段：

``` shell
* 1-交易金额
* 2-交易笔数,3-交易人数
* 4-笔单价,5-客单价,6-上午笔数占比
* 7-午间笔数占比,8-下午笔数占比,9-晚间笔数占比,10-深夜笔数占比
* （注：上午 00:00-9:59；午间 10:00-12:59；下午 13:00-16:59；晚间 17:00-20:59；深夜 21:00-23:59）
```


> 未完待续